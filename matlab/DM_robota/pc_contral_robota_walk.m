% set up serialportlist
clear
addpath('.\trajectory_planner')
% s = serialport("COM1",115200);
s = DM_serial_CAN('COM5')
                      
position_zero=[ 0, 0.5, -1, ...
                0, -0.5, 1, ...
                0, 0.5, -1, ...
                0, -0.5, 1];
            
% for i=1:12
%     % write(s,['#',num2str(i),'P' num2str(position_zero(i)) 'T1000!'],"uint8");
%     ['#',num2str(i),'P' num2str(position_zero(i)) 'T1000!']
% end
% s.f_moter_disen_all()

s.f_moter_en_all()
pause(1)
s.f_moter_go_zero_all()
pause(3)

% read walk step
[foot_step_x, foot_step_y] = trajectory_planner();
plot(foot_step_x, foot_step_y)

wait_time = 1.5;
while(1)
    serial_walk_control(s,0.0,0.0,0,10,0,-150,1,foot_step_x,foot_step_y);
end

% foot_step_y = [279.784161172141,279.186908630917,278.277002300741,277.115005759996,275.754049819188,274.240538017160,272.614797512661,270.911678712097,269.161106838920,267.388588516087,265.615676300516,263.860393977703,262.137625295807,260.459468691776,258.835560437576,257.273368512539,255.778459388321,254.354739796168,253.004675432211,251.729488445440,250.529335445055,249.403467658971,248.350374773650,247.367913887052,246.453424911499,245.603833671643,244.815743854573,244.085518884410,243.409354712554,242.783344437067,242.203535590490,241.665980864702,241.166782974233,240.702134295633,240.268351860143,239.861908219853,239.479458653788,239.117865129785,238.774217390597,238.445851488256,238.130366049206,237.825636514050,237.529827559732,237.241403878501,236.959139456928,236.682125469386,236.409776873649,236.141837771345,235.878385572837,235.619833984375,235.366934815005,235.120778581331,234.882793869785,234.654745398101,234.438730700184,234.237175341054,234.052826550887,233.888745149043,233.748295610053,233.635134103552,233.553194318798,233.506670861300,233.499999983990,233.537837387820,233.625032796419,233.766600976033,233.967688835097,234.233538197038,234.569443794824,234.980705986075,235.472577632684,236.050204528515,236.718558692392,237.482363770785,238.346011714935,239.313469810093,240.388177039675,241.572928663905,242.869747780455,244.279742513152,245.802947343574,247.438146958587,249.182680834279,251.032226612511,252.980560150118,255.019289931825,257.137563335859,259.321742025226,261.555043507194,263.817145658071,266.083750749154,268.326105232242,270.510471248619,272.597545513279,274.541820895751,276.290885669441,277.784655032326,278.954529112336,279.722471260182,280,280.157035805566,280.313935001052,280.470524379144,280.626649404310,280.782155999279,280.936890697097,281.090700792585,281.243434493039,281.394941068032,281.545070998166,281.693676122632,281.840609785429,281.985726980093,282.128884492803,282.269941043716,282.408757426397,282.545196645194,282.679124050441,282.810407471340,282.938917346399,283.064526851294,283.187112024028,283.306551887270,283.422728567744,283.535527412556,283.644837102345,283.750549761139,283.852561062818,283.950770334074,284.045080653759,284.135398948539,284.221636084743,284.303706956333,284.381530568888,284.455030119539,284.524133072763,284.588771231970,284.648880806803,284.704402476090,284.755281446392,284.801467506071,284.842915074851,284.879583248794,284.911435840669,284.938441415667,284.960573322422,284.977809719312,284.990133596013,284.997532790291,285.000000000000,284.997532790291,284.990133596013,284.977809719312,284.960573322422,284.938441415667,284.911435840669,284.879583248794,284.842915074851,284.801467506071,284.755281446392,284.704402476090,284.648880806803,284.588771231970,284.524133072763,284.455030119539,284.381530568888,284.303706956333,284.221636084743,284.135398948539,284.045080653759,283.950770334074,283.852561062818,283.750549761139,283.644837102345,283.535527412556,283.422728567744,283.306551887270,283.187112024028,283.064526851294,282.938917346399,282.810407471340,282.679124050441,282.545196645194,282.408757426397,282.269941043716,282.128884492803,281.985726980093,281.840609785429,281.693676122632,281.545070998166,281.394941068032,281.243434493039,281.090700792585,280.936890697097,280.782155999279,280.626649404310,280.470524379144,280.313935001052,280.157035805566,279.999981633974];
% foot_step_x = [64.7962241881123,66.9281948440417,68.9047458853030,70.7336632089232,72.4214871275340,73.9734081466605,75.3932398834638,76.6834545548556,77.8452679930586,78.8787625824203,79.7830378556315,80.5563797434742,81.1964406427908,81.7004235554845,82.0652645599333,82.2878088081130,82.3649760998204,82.2939128724922,82.0721281639968,81.6976117592065,81.1689333218330,80.4853218436418,79.6467252163808,78.6538501502127,77.5081830286980,76.2119926070127,74.7683157296147,73.1809274684994,71.4542972659614,69.5935328088481,67.6043134670304,65.4928151996159,63.2656288705983,60.9296739234989,58.4921093443607,55.9602437964515,53.3414467404231,50.6430622626238,47.8723272239227,45.0362952138752,42.1417676524195,39.1952332255899,36.2028166749700,33.1702377847724,30.1027812274658,27.0052777406881,23.8820969166770,20.7371516924551,17.5739144363544,14.3954443359375,11.2044256057212,8.00321585206032,4.79390375878943,1.57837509240965,-1.64161412862989,-4.86435859807750,-8.08812024531625,-11.3110418570447,-14.5310594324856,-17.7458149855232,-20.9525715656347,-24.1481323068966,-27.3287653293420,-30.4901363081892,-33.6272504926440,-36.7344058958352,-39.8051592897264,-42.8323065223615,-45.8078785283573,-48.7231542260251,-51.5686912847656,-54.3343755033598,-57.0094892624317,-59.5827992016640,-62.0426629233360,-64.3771541374586,-66.5742052392998,-68.6217658465369,-70.5079753197783,-72.2213467459584,-73.7509592783283,-75.0866550986851,-76.2192365963852,-77.1406586438718,-77.8442100892641,-78.3246777823629,-78.5784856006467,-78.6038000458836,-78.4005930393470,-77.9706515537933,-77.3175226828730,-76.4463816630621,-75.3638092291274,-74.0774635011926,-72.5956303693243,-70.9266350598978,-69.0780962365581,-67.0560026071199,-64.8635905760431,-62.5000000000000,-61.2500000000000,-60,-58.7500000000000,-57.5000000000000,-56.2500000000000,-55,-53.7500000000000,-52.5000000000000,-51.2500000000000,-50,-48.7500000000000,-47.5000000000000,-46.2500000000000,-45,-43.7500000000000,-42.5000000000000,-41.2500000000000,-40,-38.7500000000000,-37.5000000000000,-36.2500000000000,-35,-33.7500000000000,-32.5000000000000,-31.2500000000000,-30,-28.7500000000000,-27.5000000000000,-26.2500000000000,-25,-23.7500000000000,-22.5000000000000,-21.2500000000000,-20.0000000000000,-18.7500000000000,-17.5000000000000,-16.2500000000000,-15,-13.7500000000000,-12.5000000000000,-11.2500000000000,-10.0000000000000,-8.75000000000000,-7.50000000000000,-6.25000000000000,-5.00000000000000,-3.75000000000000,-2.50000000000000,-1.25000000000000,0,1.25000000000000,2.50000000000000,3.75000000000000,5.00000000000000,6.25000000000001,7.50000000000001,8.75000000000000,10.0000000000000,11.2500000000000,12.5000000000000,13.7500000000000,15,16.2500000000000,17.5000000000000,18.7500000000000,20.0000000000000,21.2500000000000,22.5000000000000,23.7500000000000,25.0000000000000,26.2500000000000,27.5000000000000,28.7500000000000,30,31.2500000000000,32.5000000000000,33.7500000000000,35,36.2500000000000,37.5000000000000,38.7500000000000,40.0000000000000,41.2500000000000,42.5000000000000,43.7500000000000,45,46.2500000000000,47.5000000000000,48.7500000000000,50,51.2500000000000,52.5000000000000,53.7500000000000,55.0000000000000,56.2500000000000,57.5000000000000,58.7500000000000,60,61.2500000000000,62.5000000000000];
